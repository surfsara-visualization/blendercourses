
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://surfsara-visualization.github.io/blendercourses/advanced/modules/advanced/python_scripting/api_summary/">
      
      <link rel="shortcut icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.5">
    
    
      
        <title>The Blender API in detail - Advanced Topics in Scientific Visualization with Blender</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.77f3fd56.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-blender-api-in-detail" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://surfsara-visualization.github.io/blendercourses/advanced" title="Advanced Topics in Scientific Visualization with Blender" class="md-header__button md-logo" aria-label="Advanced Topics in Scientific Visualization with Blender">
      
  <img src="../../../../images/surf-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Advanced Topics in Scientific Visualization with Blender
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Blender API in detail
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../overview/introduction.advanced/" class="md-tabs__link">
        Course overview
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../1_api_basics/" class="md-tabs__link md-tabs__link--active">
        Python scripting
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../advanced_materials/introduction/" class="md-tabs__link">
        Node-based materials
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../mesh_editing/introduction/" class="md-tabs__link">
        Mesh edit mode
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../final_project/final_project/" class="md-tabs__link">
        Final project
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../references/interface/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://surfsara-visualization.github.io/blendercourses/advanced" title="Advanced Topics in Scientific Visualization with Blender" class="md-nav__button md-logo" aria-label="Advanced Topics in Scientific Visualization with Blender">
      
  <img src="../../../../images/surf-logo.svg" alt="logo">

    </a>
    Advanced Topics in Scientific Visualization with Blender
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Course overview
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Course overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Course overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/introduction.advanced/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/setup.advanced/" class="md-nav__link">
        Course setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/schedule.advanced/" class="md-nav__link">
        Schedule
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/conventions/" class="md-nav__link">
        Text conventions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../overview/about/" class="md-nav__link">
        About
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Python scripting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Python scripting" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Python scripting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../1_api_basics/" class="md-nav__link">
        Blender API basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../2_accessing_data/" class="md-nav__link">
        Accessing Blender data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../3_geometry_colors_and_materials/" class="md-nav__link">
        Creating geometry, colors and materials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../4_volumetric_data/" class="md-nav__link">
        Visualizing volumetric data
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          The Blender API in detail
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        The Blender API in detail
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-modules" class="md-nav__link">
    API modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#developer-settings" class="md-nav__link">
    Developer settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-blocks" class="md-nav__link">
    Data-blocks
  </a>
  
    <nav class="md-nav" aria-label="Data-blocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique-data-block-names" class="md-nav__link">
    Unique data-block names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objects-and-object-data" class="md-nav__link">
    Objects and object data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#native-blender-data-structures" class="md-nav__link">
    Native Blender data structures
  </a>
  
    <nav class="md-nav" aria-label="Native Blender data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inspecting-values" class="md-nav__link">
    Inspecting values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-organization" class="md-nav__link">
    Data organization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertices-and-matrices" class="md-nav__link">
    Vertices and matrices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selections" class="md-nav__link">
    Selections
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#often-used-values-and-operations" class="md-nav__link">
    Often used values and operations
  </a>
  
    <nav class="md-nav" aria-label="Often used values and operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scene" class="md-nav__link">
    Scene
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#camera" class="md-nav__link">
    Camera
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#render-settings" class="md-nav__link">
    Render settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#animation" class="md-nav__link">
    Animation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object-transformations" class="md-nav__link">
    Object transformations
  </a>
  
    <nav class="md-nav" aria-label="Object transformations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geometry-coordinates" class="md-nav__link">
    Geometry coordinates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-quirks" class="md-nav__link">
    API quirks
  </a>
  
    <nav class="md-nav" aria-label="API quirks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#object-modes" class="md-nav__link">
    Object modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupting-long-running-scripts" class="md-nav__link">
    Interrupting (long-running) scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interaction-with-the-undo-system" class="md-nav__link">
    Interaction with the Undo system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    Operators
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-context" class="md-nav__link">
    Operator context
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meshes" class="md-nav__link">
    Meshes
  </a>
  
    <nav class="md-nav" aria-label="Meshes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-mesh-high-level" class="md-nav__link">
    Creating a mesh (high-level)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#careful-invalid-data" class="md-nav__link">
    Careful: invalid data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-mesh-low-level" class="md-nav__link">
    Creating a mesh (low-level)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-edges-when-creating-a-mesh" class="md-nav__link">
    Specifying edges when creating a mesh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-mesh-data-object-mode" class="md-nav__link">
    Accessing mesh data (object mode)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-colors" class="md-nav__link">
    Vertex colors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uv-coordinates" class="md-nav__link">
    UV coordinates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bmesh" class="md-nav__link">
    BMesh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#materials" class="md-nav__link">
    Materials
  </a>
  
    <nav class="md-nav" aria-label="Materials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#material-slots" class="md-nav__link">
    Material slots
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-properties" class="md-nav__link">
    Custom properties
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#into-the-deep-end" class="md-nav__link">
    Into the deep end...
  </a>
  
    <nav class="md-nav" aria-label="Into the deep end...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-block-users-and-garbage-collection" class="md-nav__link">
    Data-block users and garbage collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-note-on-bpydata-bpydataobjects" class="md-nav__link">
    A note on bpy.data, bpy.data.objects, ...
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parenting" class="md-nav__link">
    Parenting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Node-based materials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Node-based materials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Node-based materials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced_materials/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced_materials/advanced_materials_assignment/" class="md-nav__link">
        Advanced materials
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Mesh edit mode
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Mesh edit mode" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Mesh edit mode
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../mesh_editing/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../mesh_editing/mesh_editing_assignment/" class="md-nav__link">
        (EXERCISE) Advanced Mesh Editing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Final project
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Final project" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Final project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../final_project/final_project/" class="md-nav__link">
        Final project: making a visualisation of your own data
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        References
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="References" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/interface/" class="md-nav__link">
        User Interface elements
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/cheat_sheet/" class="md-nav__link">
        Cheat sheet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/official/" class="md-nav__link">
        Official sources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/community/" class="md-nav__link">
        Community resources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/scene/" class="md-nav__link">
        Scene resources (3D models, materials, textures)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-modules" class="md-nav__link">
    API modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#developer-settings" class="md-nav__link">
    Developer settings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-blocks" class="md-nav__link">
    Data-blocks
  </a>
  
    <nav class="md-nav" aria-label="Data-blocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique-data-block-names" class="md-nav__link">
    Unique data-block names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objects-and-object-data" class="md-nav__link">
    Objects and object data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#native-blender-data-structures" class="md-nav__link">
    Native Blender data structures
  </a>
  
    <nav class="md-nav" aria-label="Native Blender data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inspecting-values" class="md-nav__link">
    Inspecting values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-organization" class="md-nav__link">
    Data organization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertices-and-matrices" class="md-nav__link">
    Vertices and matrices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selections" class="md-nav__link">
    Selections
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#often-used-values-and-operations" class="md-nav__link">
    Often used values and operations
  </a>
  
    <nav class="md-nav" aria-label="Often used values and operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scene" class="md-nav__link">
    Scene
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects" class="md-nav__link">
    Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#camera" class="md-nav__link">
    Camera
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#render-settings" class="md-nav__link">
    Render settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#animation" class="md-nav__link">
    Animation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#object-transformations" class="md-nav__link">
    Object transformations
  </a>
  
    <nav class="md-nav" aria-label="Object transformations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geometry-coordinates" class="md-nav__link">
    Geometry coordinates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-quirks" class="md-nav__link">
    API quirks
  </a>
  
    <nav class="md-nav" aria-label="API quirks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#object-modes" class="md-nav__link">
    Object modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupting-long-running-scripts" class="md-nav__link">
    Interrupting (long-running) scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interaction-with-the-undo-system" class="md-nav__link">
    Interaction with the Undo system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    Operators
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-context" class="md-nav__link">
    Operator context
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meshes" class="md-nav__link">
    Meshes
  </a>
  
    <nav class="md-nav" aria-label="Meshes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-mesh-high-level" class="md-nav__link">
    Creating a mesh (high-level)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#careful-invalid-data" class="md-nav__link">
    Careful: invalid data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-mesh-low-level" class="md-nav__link">
    Creating a mesh (low-level)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specifying-edges-when-creating-a-mesh" class="md-nav__link">
    Specifying edges when creating a mesh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-mesh-data-object-mode" class="md-nav__link">
    Accessing mesh data (object mode)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vertex-colors" class="md-nav__link">
    Vertex colors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uv-coordinates" class="md-nav__link">
    UV coordinates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bmesh" class="md-nav__link">
    BMesh
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#materials" class="md-nav__link">
    Materials
  </a>
  
    <nav class="md-nav" aria-label="Materials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#material-slots" class="md-nav__link">
    Material slots
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-properties" class="md-nav__link">
    Custom properties
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#into-the-deep-end" class="md-nav__link">
    Into the deep end...
  </a>
  
    <nav class="md-nav" aria-label="Into the deep end...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-block-users-and-garbage-collection" class="md-nav__link">
    Data-block users and garbage collection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-note-on-bpydata-bpydataobjects" class="md-nav__link">
    A note on bpy.data, bpy.data.objects, ...
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parenting" class="md-nav__link">
    Parenting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="the-blender-api-in-detail">The Blender API in detail<a class="headerlink" href="#the-blender-api-in-detail" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The Blender Python API mostly consists of a thin layer on top of the underlying Blender C/C++ data structures and methods. The underlying C/C++ code is used to automatically generate the Python API during the build process of the Blender executable, which means the API is always up-to-date with respect to the underlying code. </p>
<p>The API isn't the only part of Blender that uses Python. Large parts of the user interface, the import/export scripts and all addons are written in Python. It is therefore relatively easy to extend Blender with, say, new UI dialogs or an importer. This is one of the strengths of the Blender Python API.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the API provides access to Blender internals at a very low level you can screw up the Blender state quite easily, causing unexpected behaviour, data corruption or even crashes. In the worst case you can end up with a file that will no longer load in Blender at all, although that's rare.</p>
<p>So when working with Python scripting save your session to file often, preferably in a number of incremental versions.</p>
<p>In cases where you suspect Blender's internal state has been corrupted you can save the current file, restart Blender and then reopen the file to help ensure you start from a known-good state.</p>
</div>
<h3 id="api-modules">API modules<a class="headerlink" href="#api-modules" title="Permanent link">&para;</a></h3>
<p>The Blender Python API is comprised of several modules, with <code>bpy</code> being the main one. But there's also useful routines in <code>mathutils</code>, <code>bmesh</code> and a few others.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The API documentation on these modules can be easily accessed from within Blender using <strong><code>Help &gt; Python API Reference</code></strong>.</p>
</div>
<p><em>By default none of the API modules, not even <code>bpy</code>, is loaded in the environment where a script file runs, so you need to import the ones you need explicitly.</em></p>
<p>The Python Console <em>does</em> import quite a few things by defaults and also sets some useful variables, like <code>C</code> to access <code>bpy.context</code> and <code>D</code> to access <code>bpy.data</code> with less typing:</p>
<div class="highlight"><pre><span></span><code><span class="n">PYTHON</span> <span class="n">INTERACTIVE</span> <span class="n">CONSOLE</span> <span class="mf">3.9</span><span class="o">.</span><span class="mi">4</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">Apr</span> <span class="mi">20</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">38</span><span class="p">)</span>  <span class="p">[</span><span class="n">GCC</span> <span class="mf">10.2</span><span class="o">.</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Builtin</span> <span class="n">Modules</span><span class="p">:</span>       <span class="n">bpy</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">props</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">utils</span><span class="p">,</span> <span class="n">bgl</span><span class="p">,</span> <span class="n">blf</span><span class="p">,</span> <span class="n">mathutils</span>
<span class="n">Convenience</span> <span class="n">Imports</span><span class="p">:</span>   <span class="kn">from</span> <span class="nn">mathutils</span> <span class="kn">import</span> <span class="o">*</span><span class="p">;</span> <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">Convenience</span> <span class="n">Variables</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">D</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]]</span>
</code></pre></div>
<h3 id="developer-settings">Developer settings<a class="headerlink" href="#developer-settings" title="Permanent link">&para;</a></h3>
<p>When developing Python scripts in Blender it can be useful to enable a few extra settings:</p>
<ul>
<li>The Python Tooltips under <strong><code>Interface &gt; Display &gt; Python Tooltips</code></strong>. When enabled a tooltip will show the corresponding Python command or a path to the data for a UI element.
    <img alt="" src="../../images/menu_add_plane.png" /></li>
<li>The <a href="https://docs.blender.org/manual/en/dev/editors/preferences/interface.html#prefs-interface-dev-extras">Developer Extras</a> under <strong><code>Interface &gt; Display &gt; Developer Extras</code></strong>. When enabled this provides multiple things:<ul>
<li>The 3D viewport overlay for a mesh in edit mode will now have an extra setting <code>Indices</code> to show the low-level indices of selected vertices/edges/faces. This can be very useful when debugging Python code that works on mesh geometry.</li>
<li>The right-click menu for a UI item, such as a button or menu entry, will now also contain an entry called <strong><code>Online Python Reference</code></strong> linking to the relevant Python documentation page.</li>
<li>It will enable <a href="https://docs.blender.org/manual/en/dev/interface/controls/templates/operator_search.html">Operator Search</a>, which will add entries to the <strong><code>F3</code></strong> search menu for operators. These will be listed after the regular menu entries in the search results.</li>
<li>It adds a new menu option <strong><code>Help &gt; Operator Cheat Sheet</code></strong> that will create a new text area called <code>OperatorList.txt</code>, which contains all available operators (see <a href="#operators">below</a>) and their default parameters. This list can give you a quick overview of the available operators, with the API documentation providing all the details.</li>
</ul>
</li>
</ul>
<p>As mentioned in the <a href="../1_api_basics/#run-scripts-within-the-blender-interface">video</a> in the introductory chapter the Info area can be useful if you want to inspect which Python calls Blender performs for certain operations. This certainly will not provide all the details in all cases, but can give some insight. You can either switch to the default Scripting workspace to check the Info area, or use the normal UI area operations to add/change an area to an Info area.</p>
<h2 id="data-blocks">Data-blocks<a class="headerlink" href="#data-blocks" title="Permanent link">&para;</a></h2>
<p>The different types of data in Blender are stored in <a href="https://docs.blender.org/manual/en/latest/files/data_blocks.html"><em>data-blocks</em></a>. For example, there's Mesh, Object, Texture and Shader data-blocks, but there's <a href="https://docs.blender.org/manual/en/latest/files/data_blocks.html#data-system-datablock-types">quite a few more</a>. One of the clever bits in the way Blender is programmed is that data-blocks contain enough information about their content (i.e. meta-data) to make them readable by both older and newer versions of Blender than the one they were written with. This meta-data system also allows the Python API for accessing those data-blocks to get generated without much manual development.</p>
<p>Data-blocks are available through Python per type under <code>bpy.data</code>, e.g. <code>bpy.data.objects</code> or <code>bpy.data.meshes</code>. The type of a data-block is the corresponding class under <code>bpy.types</code>, e.g.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_types</span><span class="o">.</span><span class="n">Object</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Object</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_types</span><span class="o">.</span><span class="n">Object</span><span class="s1">&#39;&gt;</span>
</code></pre></div>
<p>Each type of data-block has its own set of attributes and methods, particular to that type. Learning the Blender Python API involves getting to know the details of the data-block types you want to work with and how they interact.</p>
<p>Blender keeps track of which data-blocks are no longer being referenced to decide when a data-block does not need to be saved (so-called garbage collection). Usually you don't need to explicitly interact with this system, but it is good to be aware that it is there, see <a href="#data-block-users-and-garbage-collection">this section</a> below for more details.</p>
<h3 id="unique-data-block-names">Unique data-block names<a class="headerlink" href="#unique-data-block-names" title="Permanent link">&para;</a></h3>
<p><em>Per type of data all the data-blocks need to have a unique name</em>. This is enforced automatically by Blender when a data-block is created by appending a number to make the name unique. For example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;my object&#39;</span><span class="p">)</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;my object&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;my object&#39;</span><span class="p">)</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;my object.001&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;my object&#39;</span><span class="p">)</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;my object.002&#39;</span><span class="p">]</span>
</code></pre></div>
<p>This usually isn't an issue, but just something to be aware of when working with referencing objects by name, as the name of a data-block you created might actually be something different than you expect.</p>
<h2 id="objects-and-object-data">Objects and object data<a class="headerlink" href="#objects-and-object-data" title="Permanent link">&para;</a></h2>
<p>When we use the word Object in these pages we mean one of the object types that can be present in a 3D scene, e.g. camera, mesh, light, etc. Such objects are of type <code>bpy.types.Object</code> and all have general properties related to their presence in the 3D scene. For example, their name, 3D transformation, visibility flags, parent, etc.</p>
<p>But a Light object needs to specify different properties than, say, a Camera object and these per-type properties are stored as <em>object data</em>. The object data can be accessed through the <code>data</code> attribute of an Object:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Both lights and cameras are Objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_types</span><span class="o">.</span><span class="n">Object</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_types</span><span class="o">.</span><span class="n">Object</span><span class="s1">&#39;&gt;</span>

<span class="c1"># But their object data are of different types</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Camera</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">PointLight</span><span class="s1">&#39;&gt;</span>

<span class="c1"># And have different attributes, relevant to that type</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;clip_start&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;dof&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;falloff_type&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div>
<p>Sometimes you want to iterate over all objects in a scene, but only perform some operation on a specific type of object. You can use the <code>type</code> attribute for checking an object's type:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
<span class="s1">&#39;CAMERA&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
<span class="s1">&#39;LIGHT&#39;</span>
</code></pre></div>
<h2 id="native-blender-data-structures">Native Blender data structures<a class="headerlink" href="#native-blender-data-structures" title="Permanent link">&para;</a></h2>
<p>When working with the Python API will you frequently use internal Blender types that appear similar to regular Python types, like lists and dictionaries. However, the Blender types are not real native Python types and behave differently in certain aspects.</p>
<p>For example, the different collections of scene elements (such as objects or meshes) that are available under <code>bpy.data</code> are of type <code>bpy_prop_collection</code>. This type is a combination of a Python list and a dictionary, sometimes called an ordered dictionary, as it allows indexing by both array position and key:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_prop_collection</span><span class="s1">&#39;&gt;</span>

<span class="c1"># Some of its methods match those of native Python data types</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;__bool__&#39;</span><span class="p">,</span> <span class="s1">&#39;__contains__&#39;</span><span class="p">,</span> <span class="s1">&#39;__delattr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__delitem__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> 
<span class="s1">&#39;__getattribute__&#39;</span><span class="p">,</span> <span class="s1">&#39;__getitem__&#39;</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> 
<span class="s1">&#39;__setattr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__setitem__&#39;</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">,</span> <span class="s1">&#39;bl_rna&#39;</span><span class="p">,</span> <span class="s1">&#39;find&#39;</span><span class="p">,</span> <span class="s1">&#39;foreach_get&#39;</span><span class="p">,</span> 
<span class="s1">&#39;foreach_set&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">,</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="s1">&#39;rna_type&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> 
<span class="s1">&#39;values&#39;</span><span class="p">]</span>

<span class="c1"># Index by position</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span>

<span class="c1"># Index by key</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span>

<span class="c1"># (key, value) pairs</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">[(</span><span class="s1">&#39;Camera&#39;</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;Cube&#39;</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]),</span> 
<span class="p">(</span><span class="s1">&#39;Light&#39;</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">])]</span>
</code></pre></div>
<p>Note that the position of an item in the collection, and hence its index, can change during a Blender session.</p>
<h3 id="inspecting-values">Inspecting values<a class="headerlink" href="#inspecting-values" title="Permanent link">&para;</a></h3>
<p>One of the more annoying aspects when working in the Blender Python Console inspecting these kinds of values is that the elements in a <code>bpy_prop_collection</code> (or other Blender types) aren't printed by default, this in contrast to a regular Python dictionary. You need to, for example, cast to a list or call its <code>values()</code> method:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Regular Python dict, prints both keys and values</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="c1"># No items printed</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span>
<span class="o">&lt;</span><span class="n">bpy_collection</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">BlendDataObjects</span><span class="o">&gt;</span>

<span class="c1"># values() returns a list, so gets printed in detail</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">list</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>           
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]]</span>

<span class="c1"># Difference in list() result:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="c1"># Returns dict *keys*</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]]</span>
<span class="c1"># Returns collection *values*</span>
</code></pre></div>
<p>The choice for not printing the values inside a <code>bpy_prop_collection</code> is (most likely) that in many cases the collection will contain large numbers of objects, so printing them all would not be too useful, or might even make the UI non-responsive for a short time.</p>
<h3 id="data-organization">Data organization<a class="headerlink" href="#data-organization" title="Permanent link">&para;</a></h3>
<p>In certain cases Blender uses a more elaborate data structure in cases where you might except low-level values, like lists. For example, the set of vertices that make up a mesh are only accessible as a collection of <code>MeshVertex</code> objects:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_prop_collection</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
<span class="mi">8</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">MeshVertex</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">[</span><span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">,</span> <span class="s1">&#39;bevel_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bl_rna&#39;</span><span class="p">,</span> <span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="s1">&#39;groups&#39;</span><span class="p">,</span> 
<span class="s1">&#39;hide&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;rna_type&#39;</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="s1">&#39;undeformed_co&#39;</span><span class="p">]</span>

<span class="c1"># Vertex coordinate (object space)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">co</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

<span class="c1"># Vertex normal</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">))</span>
</code></pre></div>
<p>The reason for this is that there's several types of data associated with a single vertex, which are all centralized in a <code>MeshVertex</code> object. In short, Blender uses a so-called array-of-structs design. The alternative design choice would have been to have separate arrays for vertex coordinates, vertex normals, etc (which would be a struct-of-arrays design).</p>
<h3 id="vertices-and-matrices">Vertices and matrices<a class="headerlink" href="#vertices-and-matrices" title="Permanent link">&para;</a></h3>
<p>The example above also shows that even a vertex coordinate is not accessed as a low-level Python data type, like a tuple, but by the <code>Vector</code> type (which is in the <code>mathutils</code> module). This has the advantage of providing many useful methods for operating on vector values:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">length</span>
<span class="mf">0.999998137353116</span>

<span class="c1"># Return a new vector that&#39;s orthogonal </span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">orthogonal</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.154698371887207</span><span class="p">))</span>

<span class="c1"># Dot product (should be zero as v and w are orthogonal)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="mf">0.0</span>

<span class="c1"># Note: v*w is element-wise product, not dot product!</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="o">*</span><span class="n">w</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.3333320915699005</span><span class="p">,</span> <span class="mf">0.3333320915699005</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.666664183139801</span><span class="p">))</span>

<span class="c1"># Cross product between two vectors</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">Vector</span><span class="p">((</span><span class="o">-</span><span class="mf">0.9999963045120239</span><span class="p">,</span> <span class="mf">0.9999963045120239</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>

<span class="c1"># Swizzling (returning vector elements in a different order)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.154698371887207</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">zxy</span>
<span class="n">Vector</span><span class="p">((</span><span class="o">-</span><span class="mf">1.154698371887207</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">,</span> <span class="mf">0.5773491859436035</span><span class="p">))</span>
</code></pre></div>
<p>The builtin <a href="https://docs.blender.org/api/current/mathutils.html"><code>mathutils</code></a> module contains many useful data types and methods for working with 3D data, including vectors and matrices, but also different methods for working with transformations (like quaternion) and colors spaces.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Transformation matrix for an object with uniform scale 2 and </span>
<span class="c1"># translation in Z of 3. These values will match with the Transform UI area</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="c1"># Create a rotation matrix</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="mf">90.0</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.549790126404332e-08</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">7.549790126404332e-08</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Transform the vector using the matrix. Note the different outcomes </span>
<span class="c1"># depending on the multiplication order.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">@</span> <span class="n">v</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.999999761581421</span><span class="p">,</span> <span class="mf">2.000000238418579</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">@</span> <span class="n">m</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.000000238418579</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.999999761581421</span><span class="p">))</span>

<span class="c1"># Also, a 3-vector is assumed to have a fourth element equal to *one* when </span>
<span class="c1"># multiplying with a matrix:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">Translation</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">@</span> <span class="n">Vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">@</span> <span class="n">Vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
</code></pre></div>
<h2 id="selections">Selections<a class="headerlink" href="#selections" title="Permanent link">&para;</a></h2>
<p>In a lot of cases you want to operate on a set of objects. You can access (read only) the current selection with <code>bpy.context.selected_objects</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">selected_objects</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Plane&#39;</span><span class="p">]]</span>
</code></pre></div>
<p>Changing the current selection can be done in several ways. Control over selection state per object can be controlled with the <code>select_get()</code> and <code>select_set()</code> methods:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">selected_objects</span>
<span class="p">[]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select_get</span><span class="p">()</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select_set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">selected_objects</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]]</span>
</code></pre></div>
<p>The full selection set can also be changed:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Select all visible objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;SELECT&#39;</span><span class="p">)</span>

<span class="c1"># Deselect all objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;DESELECT&#39;</span><span class="p">)</span>

<span class="c1"># Toggle the selection state for each object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">select_all</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;TOGGLE&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Note that the default mode for <code>bpy.ops.object.select_all()</code> when not specified is <code>TOGGLE</code>. Also note that the selection methods above operate only on objects that are currently <em>visible</em> objects in the scene (in terms of the outliner eye icon), just like for the selection hotkeys (like <strong><code>A</code></strong>) in the 3D viewport. </p>
<h2 id="often-used-values-and-operations">Often used values and operations<a class="headerlink" href="#often-used-values-and-operations" title="Permanent link">&para;</a></h2>
<h3 id="scene">Scene<a class="headerlink" href="#scene" title="Permanent link">&para;</a></h3>
<ul>
<li>Current scene: <code>bpy.context.scene</code> (read-only)</li>
</ul>
<h3 id="objects">Objects<a class="headerlink" href="#objects" title="Permanent link">&para;</a></h3>
<ul>
<li>Active object: <code>bpy.context.active_object</code> (read-only)</li>
<li>Selected objects: <code>bpy.context.selected_objects</code> (read-only)</li>
<li>Delete selected objects: <code>bpy.ops.object.delete()</code></li>
</ul>
<h3 id="camera">Camera<a class="headerlink" href="#camera" title="Permanent link">&para;</a></h3>
<ul>
<li>Active camera object: <code>Scene.camera</code> (this is the camera <em>object</em>, not camera <em>object data</em>)</li>
<li>Type: <code>Camera.type</code> ("PERSP", "ORTHO", ...)</li>
<li>Focal length: <code>Camera.lens</code>  (in mm)</li>
<li>Clipping distances: <code>Camera.clip_start</code>, <code>Camera.clip_end</code></li>
</ul>
<h3 id="render-settings">Render settings<a class="headerlink" href="#render-settings" title="Permanent link">&para;</a></h3>
<ul>
<li>Image resolution: <ul>
<li>Width: <code>Scene.render.settings.resolution_x</code></li>
<li>Height: <code>Scene.render.settings.resolution_y</code> </li>
<li>Percentage: <code>Scene.render.settings.resolution_percentage</code></li>
</ul>
</li>
<li>Output file: <code>Scene.render.filepath</code></li>
<li>Image output type: <code>Scene.render.image_settings.file_format</code> ("PNG", "JPEG", ...)</li>
<li>Number of samples per pixel (Cycles): <code>Scene.cycles.samples</code></li>
</ul>
<h3 id="animation">Animation<a class="headerlink" href="#animation" title="Permanent link">&para;</a></h3>
<ul>
<li>Current frame <code>Scene.frame_current</code></li>
<li>Frame range: <code>Scene.frame_start</code>, <code>Scene.frame_end</code></li>
<li>Frame rate: <code>Scene.render.fps</code></li>
</ul>
<h2 id="object-transformations">Object transformations<a class="headerlink" href="#object-transformations" title="Permanent link">&para;</a></h2>
<p>The <code>matrix_world</code> attribute of an <code>Object</code> contains the object-to-world transform that places the object in the 3D scene:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3065159320831299</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.2441697120666504</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">1.2577730417251587</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
</code></pre></div>
<p>Comparing this matrix with the values set in the Transform panel, you can see the location is stored in the right-most column of the matrix and the scaling along the diagonal. If there was a rotation set on this object some of these values would not be as recognizable anymore. </p>
<p><img alt="" src="../../images/transformed_cube.png" /></p>
<p>The location, rotation and scale values can also be inspected and set separately:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">location</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.3065159320831299</span><span class="p">,</span> <span class="mf">2.2441697120666504</span><span class="p">,</span> <span class="mf">1.2577730417251587</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">rotation_euler</span>
<span class="n">Euler</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">scale</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">1.3376139402389526</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1"># Needs value in radians</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">rotation_euler</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.7071067690849304</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7071067690849304</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.7071067690849304</span><span class="p">,</span> <span class="mf">0.7071067690849304</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
</code></pre></div>
<p>See <a href="#parenting">the section on parenting</a> below for some subtle effects on transformations in cases object parenting is used.</p>
<h3 id="geometry-coordinates">Geometry coordinates<a class="headerlink" href="#geometry-coordinates" title="Permanent link">&para;</a></h3>
<p>Mesh geometry in Blender stores vertex coordinates (and other geometric information) in object-space coordinates. But a mesh (or object in general) will usually get transformed to a specific position, scaling and orientation in the scene. As described above the net transform from object-space to world-space coordinates, also called the object-to-world transform, is available through <code>matrix_world</code>. In cases where you need to have access to geometric data <em>in world-space</em>, say vertex coordinates, you need to apply the <code>matrix_world</code> transform manually. </p>
<p>For example, given the cube transformed as shown above, with vertex 7 selected (visible bottom-left in the image below):</p>
<p><img alt="" src="../../images/global_vertex_coordinate.png" style="width:60%" /></p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3065159320831299</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.2441697120666504</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3376139402389526</span><span class="p">,</span> <span class="mf">1.2577730417251587</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="c1"># The object-space coordinate of this vertex</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">co</span>
<span class="n">Vector</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>

<span class="c1"># The world-space coordinate of this vertex, which matches</span>
<span class="c1"># what the Transform UI shows. Note the Global display mode</span>
<span class="c1"># select in the UI, if we select Local if will show (-1, -1, -1).</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">matrix_world</span> <span class="o">@</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">co</span>
<span class="n">Vector</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0310980081558228</span><span class="p">,</span> <span class="mf">0.9065557718276978</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07984089851379395</span><span class="p">))</span>
</code></pre></div>
<h2 id="api-quirks">API quirks<a class="headerlink" href="#api-quirks" title="Permanent link">&para;</a></h2>
<p>Working with the Blender Python API has some peculiarities compared to your average Python scripting. These have to do with the way the API is structured, but also how it interacts with the Blender internals. The API manual contains a lengthy <a href="https://docs.blender.org/api/current/info_gotcha.html">page</a> on some gotchas, but here we list some of the common ones.</p>
<h3 id="object-modes">Object modes<a class="headerlink" href="#object-modes" title="Permanent link">&para;</a></h3>
<p>An object is always in one of several modes. These modes are the same ones you work with in the UI: Object mode, Edit mode, etc. The current mode for an object can be retrieved through the <code>mode</code> property:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">mode</span>
<span class="s1">&#39;OBJECT&#39;</span>

<span class="c1"># &lt;enter edit mode with TAB&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">mode</span>
<span class="s1">&#39;EDIT&#39;</span>
</code></pre></div>
<p><em>Depending on the current mode of a mesh object certain data might not be up-to-date or even unavailable when accessing it through the Python API</em>, this is especially true when an object is in Edit Mode. This is because the edit mode uses its own copy of the data to let you edit, which is synced with the underlying mesh data when going in and out of edit mode. See <a href="https://docs.blender.org/api/current/info_gotcha.html#modes-and-mesh-access">here</a> for the relevant section in the API docs.</p>
<p>An example continuing with the Cube mesh above:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">mode</span>
<span class="s1">&#39;OBJECT&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="c1"># Check UV map data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">uv_layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="mi">24</span>

<span class="c1"># &lt;enter edit mode with TAB&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">mode</span>
<span class="s1">&#39;EDIT&#39;</span>

<span class="c1"># UV map data now empty...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">uv_layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="mi">0</span>
</code></pre></div>
<p>In most cases when working on low-level data such as mesh geometry you want the object to be in object mode (or use the <code>bmesh</code> module when you need the object be in edit mode). It's usually a good idea to add a check at the top of your script to verify the current mode is what you expect:</p>
<div class="highlight"><pre><span></span><code><span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s1">&#39;OBJECT&#39;</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Active object needs to be in object mode!&#39;</span><span class="p">)</span>
</code></pre></div>
<p>There are alternatives for still allowing a mesh to be in edit-mode when accessing its data from a script, see the <a href="https://docs.blender.org/api/current/info_gotcha.html#modes-and-mesh-access">API docs</a> for details.</p>
<h3 id="interrupting-long-running-scripts">Interrupting (long-running) scripts<a class="headerlink" href="#interrupting-long-running-scripts" title="Permanent link">&para;</a></h3>
<p>During script development you might get in a situation where your code is stuck in a loop, or takes much longer than you like. Interrupting a running script can usually be done by pressing <strong><code>Ctrl-C</code></strong> <em>in the terminal console window</em>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">pass</span>
<span class="o">...</span>     

<span class="c1"># Uh oh, execution stuck in a loop and the UI will now have become unresponsive</span>

<span class="c1"># Pressing Ctrl-C in the terminal console window interrupts script execution,</span>
<span class="c1"># as it raises a KeyboardInterrupt</span>

<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;blender_console&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">KeyboardInterrupt</span>
</code></pre></div>
<h3 id="interaction-with-the-undo-system">Interaction with the Undo system<a class="headerlink" href="#interaction-with-the-undo-system" title="Permanent link">&para;</a></h3>
<p>When you undo certain operations Blender might <em>re-create</em> certain data, which might cause existing references to the original data to become invalid. This can be especially noticeable when working interactively in the Python Console. For example, with a cube object as active object in the 3D viewport:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># The Cube is the active object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="c1"># Save a reference to it</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>

<span class="c1"># &lt;Grab the object in the 3D viewport and move it somewhere else&gt;</span>

<span class="c1"># Object reference still valid</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="c1"># &lt;Undo the object translation in the 3D viewport&gt;</span>

<span class="c1"># Object reference has now become invalid</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="o">&lt;</span><span class="n">bpy_struct</span><span class="p">,</span> <span class="n">Object</span> <span class="n">invalid</span><span class="o">&gt;</span>

<span class="c1"># Reason: object referenced under name &#39;Cube&#39; has changed</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">o</span>
<span class="kc">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">id</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
<span class="mi">140543077302976</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">id</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">])</span>
<span class="mi">140543077308608</span>

<span class="c1"># Will need to reacquire active object, or consistently use bpy.data.objects[&#39;Cube&#39;] </span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>
</code></pre></div>
<h2 id="operators">Operators<a class="headerlink" href="#operators" title="Permanent link">&para;</a></h2>
<p>A special class of important API routines are the so-called <em>operators</em>. These are usually higher-level operations, such as adding a new cube mesh, deleting the current set of selected objects or running a file importer. As noted above many parts of the Blender UI are set up with Python scripts and in a lot of cases the operations you perform in the UI through menu actions or shortcut keys will simply call the relevant operator from Python to do the actual work. </p>
<p>The Info area will show most operators as they get execute, but you can also check when the Python Tooltips are enabled (see <a href="#developer-settings">above</a>) what API call is made for a certain UI element. For example, adding a plane mesh through the Add menu will call the operator <code>bpy.ops.mesh.primitive_plane_add()</code>, as the tooltip shows:</p>
<p><img alt="" src="../../images/menu_add_plane.png" /></p>
<p>You can simply call the operator directly from Python to add a plane in exactly the same way as with the menu option:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">primitive_plane_add</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;FINISHED&#39;</span><span class="p">}</span>

<span class="c1"># A plane mesh is now added to the scene</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Plane&#39;</span><span class="p">]]</span>
</code></pre></div>
<p>Many of the operators take parameters, to influence the results. For example, with <code>bpy.ops.mesh.primitive_plane_add()</code> you can set the initial size and location of the plane (see the <a href="https://docs.blender.org/api/current/bpy.ops.mesh.html#bpy.ops.mesh.primitive_plane_add">API docs</a> for all the parameters):</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">primitive_plane_add</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="p">{</span><span class="s1">&#39;FINISHED&#39;</span><span class="p">}</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Note that operator parameters can only be passed using <a href="https://docs.blender.org/api/current/bpy.ops.html">keyword arguments</a>.</p>
</div>
<h3 id="operator-context">Operator context<a class="headerlink" href="#operator-context" title="Permanent link">&para;</a></h3>
<p>This is all very nice and powerful, but operators have a few inherent properties that can make them tricky to work with.</p>
<p>An operator's execution crucially depends on the <em>context</em> in which it is called, where it gets most of the data it needs. As shown above simple parameter values can usually be passed, but values like the objects to operate on are retrieved implicitly. For example, to join a set of mesh objects into a single one you can call the operator <code>bpy.ops.object.join()</code>. But the current context needs to be correctly set for the operator to work:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># We have no objects selected</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">selected_objects</span>
<span class="p">[]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">Active</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">selected</span> <span class="n">mesh</span>
<span class="p">{</span><span class="s1">&#39;CANCELLED&#39;</span><span class="p">}</span>

<span class="c1"># After selecting 3 objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">selected_objects</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">],</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube.002&#39;</span><span class="p">]]</span>

<span class="c1"># Now it works</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;FINISHED&#39;</span><span class="p">}</span>
</code></pre></div>
<p>As can be seen above an operator only returns a value indicating the execution status. When calling the operator in the Python Console as above some extra info is printed. But when calling operators from scripts the status return value is all you have to go on, as the extra message isn't printed when the script is executed. And in some cases the reason an operator fails can be quite unclear:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">selected_objects</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Camera&#39;</span><span class="p">]]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">intersect_boolean</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;blender_console&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="n">File</span> <span class="s2">&quot;/usr/share/blender/2.92/scripts/modules/bpy/ops.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">132</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__call__</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">_op_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idname_py</span><span class="p">(),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kw</span><span class="p">)</span>
<span class="ne">RuntimeError</span><span class="p">:</span> <span class="n">Operator</span> <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">intersect_boolean</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="n">failed</span><span class="p">,</span> <span class="n">context</span> <span class="ow">is</span> <span class="n">incorrect</span>
</code></pre></div>
<p>This merely shows that the so-called <em>poll function</em> failed. The poll function is used by operators to determine if they can execute in the current context, by checking certain preconditions on things like the selected object(s), the type of data or an object mode. In this case the <code>bpy.ops.mesh.intersect_boolean()</code> operator doesn't perform a boolean intersection on multiple meshes, but only on the faces of a single object in edit mode, but you can't tell from the error message (nor does the <a href="https://docs.blender.org/api/current/bpy.ops.mesh.html?highlight=boolean#bpy.ops.mesh.intersect_boolean">documentation</a> make that clear):</p>
<p><img alt="" src="../../images/face_intersect_operator.png" /></p>
<p>To actually perform a boolean intersection on two objects from a Python script requires us to do what we would be do in the UI: add a Boolean modifier on one of the objects and set its parameters. We <em>could</em> take advantage of the Python Tooltips to see which operator we need:</p>
<p><img alt="" src="../../images/boolean_modifier.png" /></p>
<p>This would suggest that using <code>bpy.ops.modifier_add(type='BOOLEAN')</code> would be what we need, but then setting the required parameters on the modifier (i.e. the object to subtract) would become tricky. So for a boolean operation, and setting object modifiers in general, there's an easier way:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>
<span class="c1"># Add a modifier on the object and set its parameters</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;boolmod&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;BOOLEAN&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mod</span><span class="o">.</span><span class="n">operation</span> <span class="o">=</span> <span class="s1">&#39;DIFFERENCE&#39;</span>

<span class="c1"># At this point the modifier is all set up. We hide</span>
<span class="c1"># the object we subtract to make the boolean result visible.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hide_viewport</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<p><img alt="" src="../../images/boolean_result.png" /></p>
<p>Unfortunately, certain operations can only be performed by calling operators. So there's a good chance that you will need to use them at some point when doing Python scripting. Hopefully this section gives some clues as how to work with them. See <a href="https://docs.blender.org/api/current/info_gotcha.html#using-operators">this section</a> for more details on all the above subtleties and issues relating to working with operators.</p>
<p>The <a href="https://docs.blender.org/api/current/bpy.ops.html"><code>bpy.ops</code></a> documentation also contains useful information on operators, including how to override an operator's implicit context with values you set yourself.</p>
<h2 id="meshes">Meshes<a class="headerlink" href="#meshes" title="Permanent link">&para;</a></h2>
<p>One of the more common scene data types to work with from Python are 3D meshes. Meshes in Blender can contain polygons of an arbitrary number of vertices
(so-called N-gons), can contain wire edges and support extra layers of data, such as vertex colors and UV coordinates. We go into a fair amount of detail on how to create and access mesh data, in several ways. As usual, the Blender <a href="https://docs.blender.org/api/current/bpy.types.Mesh.html">API docs on the <code>Mesh</code> type</a> contain many more details, but we feel the discussion below is a good summary to get you started for many use cases.</p>
<h3 id="creating-a-mesh-high-level">Creating a mesh (high-level)<a class="headerlink" href="#creating-a-mesh-high-level" title="Permanent link">&para;</a></h3>
<p>As shown earlier the <a href="https://docs.blender.org/api/current/bpy.types.Mesh.html#bpy.types.Mesh.from_pydata"><code>Mesh.from_pydata(vertices, edges, faces)</code></a> method
allows a simple and high-level way of creating a mesh. This method doesn't offer full control over the created
mesh and isn't very fast for large meshes, but it can be good enough in a lot of cases. </p>
<p>It takes three lists of values, or actually, any Python iterable that matches the expected form:</p>
<ul>
<li>vertices: a sequence of float triples, e.g. <code>[(1.0, 2.0, 3.0), (4, 5, 6), ...]</code></li>
<li>edges: a sequence of integer pairs (vertex indices), that define edges by. If <code>[]</code> is passed edges are inferred from polygons</li>
<li>faces: a sequence of one or more polygons, each defined as a sequence of 3 or more vertex indices. E.g. <code>[(0, 1, 2), (1, 2, 3, 4), ...]</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The choice of how the mesh data is passed might incur an overhead in memory usage and processing time, 
especially when regular Python data structures, like lists, are used. An alternative would
be to pass NumPy arrays.</p>
</div>
<p>For the examples below we assume that no explicit list of edges is passed. Edges will then 
be created implicitly based on the polygons specified, which is usually what is preferred.
We discuss explicitly specifying edges <a href="#specifying-edges-when-creating-a-mesh">below</a>. </p>
<p>An example of creating a simple mesh:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a mesh consisting of 3 polygons using 6 vertices</span>

<span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>      <span class="p">(</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>    <span class="p">(</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>    
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>    
<span class="p">]</span>

<span class="n">polygons</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>   <span class="c1"># Quad</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>      <span class="c1"># Triangle</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>       <span class="c1"># Triangle</span>
<span class="p">]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my mesh&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">from_pydata</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="p">[],</span> <span class="n">polygons</span><span class="p">)</span>
</code></pre></div>
<p>At this point we have created a new <code>Mesh</code> Python object, which corresponds to Object Data of type Mesh.
Object Data cannot be directly added to a scene, but needs to be referenced by a 3D Object:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create an object referencing the mesh data</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my mesh&#39;</span><span class="p">,</span> <span class="n">object_data</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Add the object to the scene</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</code></pre></div>
<p>The resulting mesh and outliner entry looks like this:</p>
<p><img alt="" src="../../images/created_mesh.png" /></p>
<h3 id="careful-invalid-data">Careful: invalid data<a class="headerlink" href="#careful-invalid-data" title="Permanent link">&para;</a></h3>
<p>Note that it is possible to set up a mesh with invalid/inconsistent data when setting
the underlying arrays manually, as is the case here. This can cause weird behaviour or even crashes. </p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 3 vertices</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span>

<span class="c1"># Invalid vertex index 3 used!</span>
<span class="n">polygons</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">]</span>   

<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my invalid mesh&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">from_pydata</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="p">[],</span> <span class="n">polygons</span><span class="p">)</span>

<span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my invalid mesh&#39;</span><span class="p">,</span> <span class="n">object_data</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</code></pre></div>
<p>When executing the above code a new mesh is added to the scene, but it will show as a <em>triangle</em>
in the 3D viewport, instead of a quad. And even though that doesn't appear to be unreasonable
behaviour in this case <em>Blender will crash if we subsequently enter edit mode on the mesh!</em></p>
<p>So the lesson here is to be careful when specifying geometry using these low-level API calls.
This actually applies to all parts of the Blender Python API in general.</p>
<p>In this case, to make sure a created mesh has valid data we can use the <code>validate()</code> method
on a <code>Mesh</code>. This will check the mesh data and remove any invalid values, e.g. by deleting
the polygon using non-existent vertex index 3 above. This might not result in a mesh that 
matches what you want based on the data, but at least you can detect this situation and handle it without Blender crashing.</p>
<p>The <code>validate()</code> method has two issues to be aware of:</p>
<ul>
<li>The method returns <code>True</code> in case the mesh does <strong>not</strong> validate, i.e. when it has issues. More specifically, it
returns <code>True</code> when <em>changes</em> were made to the mesh data to remove invalid values.</li>
<li>It will only report on the specific issues found when called with <code>validate(verbose=True)</code> and then will only output to the console.</li>
</ul>
<p>But it is still a good idea to always validate a mesh when creating it manually:</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my invalid mesh&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">from_pydata</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="p">[],</span> <span class="n">polygons</span><span class="p">)</span>

<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mesh had issues and has been altered! See console output for details&#39;</span><span class="p">)</span>
</code></pre></div>
<p>In the example of the invalid mesh data above this results in these message being 
printed in the console output:</p>
<div class="highlight"><pre><span></span><code>ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:351 BKE_mesh_validate_arrays:     Edge 0: v2 index out of range, 3
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:351 BKE_mesh_validate_arrays:     Edge 3: v2 index out of range, 3
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:605 BKE_mesh_validate_arrays:     Loop 3 has invalid vert reference (3)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:782 BKE_mesh_validate_arrays:     Loop 0 is unused.
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:782 BKE_mesh_validate_arrays:     Loop 1 is unused.
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:782 BKE_mesh_validate_arrays:     Loop 2 is unused.
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:782 BKE_mesh_validate_arrays:     Loop 3 is unused.
</code></pre></div>
<p>After <code>validate()</code> returns we can see in this case that invalid data was indeed removed:
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">polygons</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="p">]</span>   
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my invalid mesh&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">from_pydata</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="p">[],</span> <span class="n">polygons</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
<span class="mi">3</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">)</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
<span class="mi">3</span>
</code></pre></div></p>
<h3 id="creating-a-mesh-low-level">Creating a mesh (low-level)<a class="headerlink" href="#creating-a-mesh-low-level" title="Permanent link">&para;</a></h3>
<p>A second, and more flexible, way of creating a mesh is using low-level calls
for setting the necessary data arrays directly on a <code>Mesh</code> object. This is especially useful in combination
with NumPy arrays, as this allows the creation of large meshes with relatively
high performance and low memory overhead.</p>
<p>Meshes in Blender are stored using 4 arrays, as attributes of the <code>bpy.types.Mesh</code> type:</p>
<ul>
<li>
<p><code>vertices</code>: vertex locations, each specified by 3 floats</p>
</li>
<li>
<p><code>loops</code>: contains the vertex indices used for defining polygons of a mesh, each polygon as a sequence of indices in the <code>vertices</code> array</p>
</li>
<li>
<p><code>polygons</code>: defines the start index of each polygon as an index in <code>loops</code>, plus the length of each polygon in number of vertices</p>
</li>
<li>
<p><code>edges</code>: defines the edges of the mesh, using two vertex indices per edge</p>
</li>
</ul>
<p>So to create a mesh at this level we need to set up the necessary values for these arrays. Here, we create the same mesh as in the previous section,
using NumPy arrays for storing the data.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Vertices (8): x1 y1 z1 x2 y2 z2 ...</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Polygons, defined in loops</span>
<span class="c1">#</span>

<span class="c1"># List of vertex indices of all loops combined</span>
<span class="n">vertex_index</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>                             <span class="c1"># Quad</span>
    <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>                                <span class="c1"># Triangle</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span>                                 <span class="c1"># Triangle</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># For each polygon the start of its indices in vertex_index</span>
<span class="n">loop_start</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Length of each polygon in number of vertices</span>
<span class="n">loop_total</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</code></pre></div>
<p>We additionally also specify texture coordinates and vertex colors. This is something
that is not possible with the high-level <code>from_pydata()</code> API shown above. Note that
we need to specify these values per vertex <em>per polygon loop</em>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Texture coordinates per vertex per polygon loop</span>
<span class="n">uv_coordinates</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="c1"># Quad   </span>
    <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>      <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>             <span class="c1"># Triangle</span>
    <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>    <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>              <span class="c1"># Triangle</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Vertex color (RGBA) per vertex per polygon loop</span>
<span class="n">vertex_colors</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div>
<p>Next, we create a new mesh using the above arrays:</p>
<div class="highlight"><pre><span></span><code><span class="n">num_vertices</span> <span class="o">=</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">3</span>
<span class="n">num_vertex_indices</span> <span class="o">=</span> <span class="n">vertex_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">num_loops</span> <span class="o">=</span> <span class="n">loop_start</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my detailed mesh&#39;</span><span class="p">)</span>

<span class="c1"># Vertices</span>
<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_vertices</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span>

<span class="c1"># Polygons</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_vertex_indices</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;vertex_index&#39;</span><span class="p">,</span> <span class="n">vertex_index</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_loops</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;loop_start&#39;</span><span class="p">,</span> <span class="n">loop_start</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;loop_total&#39;</span><span class="p">,</span> <span class="n">loop_total</span><span class="p">)</span>

<span class="c1"># Create UV coordinate layer and set values</span>
<span class="n">uv_layer</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">uv_layers</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="n">uv_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;uv&#39;</span><span class="p">,</span> <span class="n">uv_coordinates</span><span class="p">)</span>

<span class="c1"># Create vertex color layer and set values</span>
<span class="n">vcol_layer</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">vertex_colors</span><span class="p">)</span>

<span class="c1"># Done, update mesh object </span>
<span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<span class="c1"># Validate mesh</span>
<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mesh data did not validate!&#39;</span><span class="p">)</span>

<span class="c1"># Create an object referencing the mesh data</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my detailed mesh&#39;</span><span class="p">,</span> <span class="n">object_data</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Add the object to the scene</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>    
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Passing a multi-dimensional NumPy array directly to <code>foreach_set()</code> will not work:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">vertices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="o">...</span>     <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>    <span class="p">(</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>    <span class="p">(</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>
<span class="o">...</span>     <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">...</span> <span class="p">],</span> <span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my detailed mesh&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;blender_console&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">RuntimeError</span><span class="p">:</span> <span class="n">internal</span> <span class="n">error</span> <span class="n">setting</span> <span class="n">the</span> <span class="n">array</span>
</code></pre></div>
<p>However, passing a flattened array <em>does</em> work:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="n">vertices</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">co</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
<span class="p">[</span><span class="n">Vector</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.20000000298023224</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.20000000298023224</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)),</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">))]</span>
</code></pre></div>
</div>
<h3 id="specifying-edges-when-creating-a-mesh">Specifying edges when creating a mesh<a class="headerlink" href="#specifying-edges-when-creating-a-mesh" title="Permanent link">&para;</a></h3>
<p>In most cases we want to create a mesh consisting of only polygons and in that case don't need to specify edges.
For certain mesh objects it can be of interest to also be able to specify edges explicitly, or even
to create a mesh that consists only of vertices and edges between them.
Edges can be used to add line segments that are not part of polygons.</p>
<p>We build upon the example mesh we created above by adding a set of 3 edges:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a mesh consisting of 3 polygons using 8 vertices, with 3 extra edges</span>
<span class="c1"># that are not part of the polygons</span>

<span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>    <span class="p">(</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">),</span>    <span class="p">(</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">polygons</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>   <span class="c1"># Quad</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>      <span class="c1"># Triangle</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>       <span class="c1"># Triangle</span>
<span class="p">]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my mesh with edges&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">from_pydata</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">polygons</span><span class="p">)</span>

<span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my mesh with edges&#39;</span><span class="p">,</span> <span class="n">object_data</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</code></pre></div>
<p>The resulting mesh and outliner entry looks like this:</p>
<p><img alt="" src="../../images/created_mesh_with_edges.png" /></p>
<p>Note that even though we specified only 3 edges explicitly the polygons in
the mesh implicitly define 8 more. These are the edges making up those polygons, with
shared edges being present only once. In total this results in 11 edges in the mesh:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
<span class="mi">11</span>
</code></pre></div>
<p>For the second, low-level, method of mesh creation edges are handled slightly different.
Edges can be set explicitly by using <code>Mesh.edges</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Vertices (8): x1 y1 z1 x2 y2 z2 ...</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Extra edges (3) not defined implicitly by polygons</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>    <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>    <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Polygons, defined in loops</span>
<span class="c1">#</span>

<span class="c1"># List of vertex indices of all loops combined</span>
<span class="n">vertex_index</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>                             <span class="c1"># Quad</span>
    <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>                                <span class="c1"># Triangle</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span>                                 <span class="c1"># Triangle</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># For each polygon the start of its indices in vertex_index</span>
<span class="n">loop_start</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Length of each polygon in number of vertices</span>
<span class="n">loop_total</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">num_vertices</span> <span class="o">=</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">3</span>
<span class="n">num_edges</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
<span class="n">num_vertex_indices</span> <span class="o">=</span> <span class="n">vertex_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">num_loops</span> <span class="o">=</span> <span class="n">loop_start</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;detailed mesh with edges&#39;</span><span class="p">)</span>

<span class="c1"># Vertices</span>
<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_vertices</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span>

<span class="c1"># Edges</span>
<span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_edges</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;vertices&#39;</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>

<span class="c1"># Polygons</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_vertex_indices</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;vertex_index&#39;</span><span class="p">,</span> <span class="n">vertex_index</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">num_loops</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;loop_start&#39;</span><span class="p">,</span> <span class="n">loop_start</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;loop_total&#39;</span><span class="p">,</span> <span class="n">loop_total</span><span class="p">)</span>

<span class="c1"># Done, update mesh object</span>
<span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<span class="c1"># Validate mesh</span>
<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mesh data did not validate!&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Here, we only specify the extra edges and not the polygon edges. But when we try to validate the 
mesh errors will be reported:</p>
<div class="highlight"><pre><span></span><code>ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 0 needs missing edge (0, 1)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 0 needs missing edge (1, 2)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 0 needs missing edge (2, 3)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 0 needs missing edge (3, 0)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 1 needs missing edge (4, 3)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 1 needs missing edge (3, 2)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 1 needs missing edge (2, 4)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 2 needs missing edge (0, 5)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 2 needs missing edge (5, 1)
ERROR (bke.mesh): ../source/blender/blenkernel/intern/mesh_validate.c:628 BKE_mesh_validate_arrays:     Poly 2 needs missing edge (1, 0)
</code></pre></div>
<p>So the polygon edges, which we did not specify, are being reported. In this case the <code>validate()</code> method will correct this and add the missing edges. But having
errors reported for regular polygon edges makes it harder to detect any other issues with the mesh data.
So the <code>Mesh.update()</code> method provides the option <code>calc_edges</code>. By default this option is <code>False</code>, 
but when set to <code>True</code> all edges in the mesh will be recalculated to be consistent with the available vertex indices,
polygons and extra edges set.</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>

<span class="c1"># Done, update mesh object and recalculate edges</span>
<span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">calc_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>Validation now succeeds:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>
<h3 id="accessing-mesh-data-object-mode">Accessing mesh data (object mode)<a class="headerlink" href="#accessing-mesh-data-object-mode" title="Permanent link">&para;</a></h3>
<p>Inspecting or using mesh data is straightforward. Here we use one of the
meshes created with the low-level methods above and retrieve some of its data. Note that Blender provides
a few values derived from the original arrays, such as <code>loop_indices</code> and <code>vertices</code> per polygon, which can be useful for
certain operations.</p>
<div class="highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;my detailed mesh&#39;</span><span class="p">]</span>

<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>            <span class="o">=&gt;</span> <span class="mi">8</span>                            
<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">)</span>            <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="c1"># 2 triangles + 1 quad = 2*3 + 1*4 = 10</span>
<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="p">)</span>               <span class="o">=&gt;</span> <span class="mi">10</span>
<span class="c1"># 8 implicit edges (for 2 triangles and 1 quad), shared edges only listed once</span>
<span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>               <span class="o">=&gt;</span> <span class="mi">8</span>                

<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">co</span>           <span class="o">=&gt;</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>         <span class="c1"># Coordinate</span>
<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>       <span class="o">=&gt;</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">0.6</span><span class="o">..</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="o">..</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="o">..</span><span class="p">))</span>   <span class="c1"># Normal</span>
<span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">select</span>       <span class="o">=&gt;</span> <span class="kc">True</span>              <span class="c1"># Selected (edit mode)</span>

<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>        <span class="o">=&gt;</span> <span class="mi">2</span>                 <span class="c1"># Useful in &#39;for p in m.polygons&#39;</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">loop_start</span>   <span class="o">=&gt;</span> <span class="mi">7</span>                 <span class="c1"># First index in loops array</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">loop_total</span>   <span class="o">=&gt;</span> <span class="mi">3</span>                 <span class="c1"># Number of vertices in loop</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">loop_indices</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>         <span class="c1"># Indices in m.loops</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span>    <span class="o">=&gt;</span> <span class="mi">0</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span>    <span class="o">=&gt;</span> <span class="mi">5</span>
<span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span>    <span class="o">=&gt;</span> <span class="mi">1</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span>     <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>         <span class="c1"># Actual vertex indices</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">select</span>       <span class="o">=&gt;</span> <span class="kc">True</span>              <span class="c1"># Selected (edit mode)</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">use_smooth</span>   <span class="o">=&gt;</span> <span class="kc">False</span>             <span class="c1"># Smooth shading enabled</span>

<span class="c1"># These are automatically computed</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">area</span>         <span class="o">=&gt;</span> <span class="mf">1.4142135381698608</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>       <span class="o">=&gt;</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.707</span><span class="o">...</span><span class="p">,</span> <span class="mf">0.707</span><span class="o">...</span><span class="p">))</span>   
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">center</span>       <span class="o">=&gt;</span> <span class="n">Vector</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.333</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.333</span><span class="o">...</span><span class="p">))</span>  

<span class="n">m</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span>        <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>            <span class="c1"># (bpy_prop_array)</span>
</code></pre></div>
<h3 id="vertex-colors">Vertex colors<a class="headerlink" href="#vertex-colors" title="Permanent link">&para;</a></h3>
<p>A mesh can have multiple sets of vertex colors. Each set has a name and for each vertex 
the associated color (but see below). By default meshes created in Blender do not have a vertex color layer.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_prop_collection</span><span class="s1">&#39;&gt;</span>

<span class="c1"># Create a new vertex color layer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vcol_layer</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;My vertex colors&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vcol_layer</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_colors</span><span class="p">[</span><span class="s2">&quot;My vertex colors&quot;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="p">)</span>
<span class="mi">1</span>

<span class="c1"># Name shown under Object Data -&gt; Vertex Colors </span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">vcol_layer</span><span class="o">.</span><span class="n">name</span>
<span class="s1">&#39;My vertex colors&#39;</span>
</code></pre></div>
<p><img alt="" src="../../images/vertexcolor_entry.png" /></p>
<p>The vertex colors themselves are accessed through the <code>data</code> member:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_prop_collection</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="mi">24</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_prop_array</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
<span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">)</span>
<span class="mi">6</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
<span class="mi">8</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">loops</span><span class="p">)</span>
<span class="mi">24</span>
</code></pre></div>
<p>One thing to notice here is that the vertex color array has 24 entries. But the Cube object only has 8 vertices and 6 polygons. The reason the higher number of vertex colors is that Blender stores separate vertex colors <em>per polygon</em>. So the Cube has 6 polygons, each defined using 4 vertices, hence 6*4=24 vertex colors in total (which is the same number as the length of the loops array). </p>
<p>This is more flexible than what most 3D file formats allow, which usually only store one color per vertex. During import Blender will duplicate those colors to set the same color for a vertex in all polygons in which it is used. An example of how to take advantage of the added flexibilit is that we can set a random color per cube face by setting each of the 4 vertex colors of a face to the same color:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../../images/vertex_colors.png" /></p>
<p>A slightly more Blender-like (and robust) way to write the above code would be to take advantage of the polygon loop indices:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">loop_indices</span><span class="p">:</span>
        <span class="n">vcol_layer</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h4 id="active-set">Active set<a class="headerlink" href="#active-set" title="Permanent link">&para;</a></h4>
<p>As noted above a mesh can have more than one layer of vertex colors. Among the sets present on a mesh there can be only one that is active. The active vertex color
layer set controls, for example, which vertex colors are visible in the 3D viewport and are edited in Vertex Paint mode. When adding a vertex color layer (and similar for UV maps described below) through the UI the active layer is changed to the newly added layer. Also, clicking in the Vertex Color layer UI changes the active layer. Below is a list of 2 vertex color layers on a mesh shown, of which <code>Another layer</code> is the active one. </p>
<p><img alt="" src="../../images/multiple_vertex_color_layers.png" /></p>
<p>The camera icon right of the vertex color names controls which layer is used during <em>rendering</em> by default (and which is set independently of the active status). But in most cases the shader used on an object will explicitly choose a vertex color layer and so override the setting in the UI list.</p>
<p>Controling the active vertex color (or UV map) layer can be done using the <code>active</code> property:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="o">.</span><span class="n">active_index</span>
<span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="o">.</span><span class="n">active</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_colors</span><span class="p">[</span><span class="s2">&quot;Another layer&quot;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">vertex_colors</span><span class="o">.</span><span class="n">active</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_colors</span><span class="p">[</span><span class="s2">&quot;Col&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="uv-coordinates">UV coordinates<a class="headerlink" href="#uv-coordinates" title="Permanent link">&para;</a></h3>
<p>UV coordinates follow the same setup as vertex colors, but instead store a 2-tuple of floats per vertex per polygon. Note that just like for vertex colors UV coordinates are also specified per vertex <em>per polygon</em>.</p>
<p>Meshes created in Blender will already have a UV map called <code>UVMap</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">uv_layers</span><span class="p">)</span>
<span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">uv_layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="s1">&#39;UVMap&#39;</span>
</code></pre></div>
<p>The actual UV values are once again stored under the <code>data</code> member:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">uv_map</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">uv_layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">uv_map</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">uv_layers</span><span class="p">[</span><span class="s2">&quot;UVMap&quot;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">uv_map</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy_prop_collection</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">uv_map</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="mi">24</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">uv_map</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bpy</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">MeshUVLoop</span><span class="s1">&#39;&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">uv_map</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">uv</span>
<span class="n">Vector</span><span class="p">((</span><span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
</code></pre></div>
<p>In general, UV maps are either set through importing or edited within Blender using the UV Editor, although there can be valid reasons for wanting to control them through the Python API.</p>
<h3 id="bmesh">BMesh<a class="headerlink" href="#bmesh" title="Permanent link">&para;</a></h3>
<p>There is another method in Blender for creating meshes and accessing their data: the so-called BMesh, which is implemented by the <code>bmesh</code> module and its <code>BMesh</code> class. BMesh is especially interesting when you want to perform more complex geometric operations on an existing mesh, or build up a mesh polygon-by-polygon instead of providing the full mesh in one go as a set of arrays as shown above. Here, we only give a brief overview of BMesh and refer to the <a href="https://docs.blender.org/api/current/bmesh.html">API docs</a> for all the details.</p>
<p>The differences of BMesh compared to working with the native mesh data structure we showed above:</p>
<ul>
<li>
<p>A BMesh holds extra data on mesh connectivity, like the neighbours of a vertex, which can be easily queried for geometric editing. The trade-off is that a BMesh will use more memory to store all this extra data, but that is usually only a limiting factor for very large meshes. </p>
</li>
<li>
<p>It is somewhat slower to create a (large) mesh using a BMesh, as each mesh element (vertex, edge, polygon) takes a Python call to create, plus needs extra calls and Python values to set up.</p>
</li>
<li>
<p>A BMesh cannot be used directly in a scene, it first needs to be converted or copied back to a <code>Mesh</code> (and so mesh data is present twice in memory at some point in time)</p>
</li>
<li>
<p>A large set of high- and low-level geometric operations, such as merging vertices within a given distance, face splitting, edge collapsing or generating a convex hull, is provided in <a href="https://docs.blender.org/api/current/bmesh.ops.html"><code>bpy.ops</code></a> and <a href="https://docs.blender.org/api/current/bmesh.utils.html"><code>bmesh.utils</code></a>. These operations would be tedious and error prone to script manually.</p>
</li>
</ul>
<p>Here's a (verbose) example of create a BMesh from scratch that holds a single triangle and edge: </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">bmesh</span> 

<span class="n">bm</span> <span class="o">=</span> <span class="n">bmesh</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>

<span class="c1"># Create 3 vertices</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="o">.</span><span class="n">new</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="o">.</span><span class="n">new</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="o">.</span><span class="n">new</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">v4</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="o">.</span><span class="n">new</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Add a triangle</span>
<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="o">.</span><span class="n">new</span><span class="p">((</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">))</span>

<span class="c1"># Add a line edge</span>
<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">new</span><span class="p">((</span><span class="n">v3</span><span class="p">,</span> <span class="n">v4</span><span class="p">))</span>

<span class="c1"># Done setting up the BMesh, now copy geometry to a regular Mesh</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;mesh&#39;</span><span class="p">)</span>
<span class="n">bm</span><span class="o">.</span><span class="n">to_mesh</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Release BMesh data, bm will no longer be usable</span>
<span class="n">bm</span><span class="o">.</span><span class="n">free</span><span class="p">()</span>

<span class="c1"># Add regular Mesh as object</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
</code></pre></div>
<p>A <code>BMesh</code> can also be created from an existing <code>Mesh</code>, edited and then copied back to the <code>Mesh</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Create a new BMesh and copy geometry from the Mesh</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">bmesh</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">bm</span><span class="o">.</span><span class="n">from_mesh</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Edit some geometry</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="o">.</span><span class="n">ensure_lookup_table</span><span class="p">()</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">co</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="mf">3.14</span>

<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="o">.</span><span class="n">ensure_lookup_table</span><span class="p">()</span>
<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Copy back to Mesh</span>
<span class="n">bm</span><span class="o">.</span><span class="n">to_mesh</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">bm</span><span class="o">.</span><span class="n">free</span><span class="p">()</span>
</code></pre></div>
<p>If a <code>Mesh</code> is currently in edit mode you can still create a <code>BMesh</code> from it, edit that and the copy the changes back, while keeping the <code>Mesh</code> in edit mode:</p>
<div class="highlight"><pre><span></span><code><span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">data</span>
<span class="k">assert</span> <span class="n">m</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;EDIT&#39;</span>

<span class="n">bm</span> <span class="o">=</span> <span class="n">bmesh</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="c1"># Note the different call, i.e. NOT from_mesh()</span>
<span class="n">bm</span><span class="o">.</span><span class="n">from_edit_mesh</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># &lt;edit BMesh&gt;</span>

<span class="c1"># Update edit-mesh of Mesh</span>
<span class="n">bm</span><span class="o">.</span><span class="n">update_edit_mesh</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">bm</span><span class="o">.</span><span class="n">free</span><span class="p">()</span>
</code></pre></div>
<p>This can be useful when you're working in edit mode on a mesh and also want to run a script on it that uses BMesh, but don't want to switch in and out of edit-mode to run the script.</p>
<p>Note that there are some <a href="https://docs.blender.org/api/current/bmesh.html#keeping-a-correct-state">things to watch out for</a> in synchronizing <code>BMesh</code> state to a <code>Mesh</code>.</p>
<p>Some examples of the geometric queries that you can do on a <code>BMesh</code> (see <a href="https://docs.blender.org/api/current/bmesh.types.html">docs</a> for more):</p>
<div class="highlight"><pre><span></span><code><span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">co</span>              <span class="c1"># Vertex coordinate as mathutils.Vector</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>          <span class="c1"># Vertex normal</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_boundary</span>     <span class="c1"># True if vertex is at the mesh boundary</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_wire</span>         <span class="c1"># True if vertex is not connected to any faces</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">link_edges</span>      <span class="c1"># Sequence of edges connected to this vertex</span>
<span class="n">bm</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">link_faces</span>      <span class="c1"># Sequence of faces connected to this vertex</span>

<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">calc_length</span><span class="p">()</span>   <span class="c1"># Length of the edge</span>
<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_boundary</span>     <span class="c1"># True if edge is boundary of a face</span>
<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_wire</span>         <span class="c1"># True if edge is not connected to any faces</span>
<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_manifold</span>     <span class="c1"># True if edge is manifold (used in at most 2 faces)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">verts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="c1"># Get one vertex of this edge</span>
<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">other_vert</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>   <span class="c1"># Get the other vertex</span>
<span class="n">bm</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">link_faces</span>      <span class="c1"># Sequence of faces connected to this edge</span>

<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">calc_area</span><span class="p">()</span>     <span class="c1"># Face area</span>
<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">calc_center_median</span><span class="p">()</span>    <span class="c1"># Median center</span>
<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">edges</span>           <span class="c1"># Sequence of edges defining this face</span>
<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">verts</span>           <span class="c1"># Sequence of vertices defining this face</span>
<span class="n">bm</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>          <span class="c1"># Face normal</span>
</code></pre></div>
<h2 id="materials">Materials<a class="headerlink" href="#materials" title="Permanent link">&para;</a></h2>
<p>As shown in one of the <a href="../3_geometry_colors_and_materials/#exercise-5-coloring-your-triangles">introductory exercises</a> it is possible to use Python to create a node-based shader. In most cases using the node-based editor in the UI is the preferred option due to its interactivity, but for certain cases it can be interesting to use Python. The general workflow for this is to create the necessary shader nodes, connected them through links as needed and then set the material on the relevant mesh.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a new material</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;my material&quot;</span><span class="p">)</span>

<span class="c1"># Enable shader nodes on the material</span>
<span class="n">mat</span><span class="o">.</span><span class="n">use_nodes</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Remove the default nodes</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">node_tree</span><span class="o">.</span><span class="n">nodes</span>
<span class="n">nodes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="c1"># Add a Principled BSDF shader node and set its base color</span>
<span class="n">shader</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ShaderNodeBsdfPrincipled&#39;</span><span class="p">)</span>
<span class="n">shader</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">shader</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;Base Color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add a Material Output node</span>
<span class="n">node_output</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ShaderNodeOutputMaterial&#39;</span><span class="p">)</span>
<span class="n">node_output</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">300</span>

<span class="c1"># Add a link between the nodes</span>
<span class="n">links</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">links</span>
<span class="n">links</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">shader</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;BSDF&#39;</span><span class="p">],</span> <span class="n">node_output</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;Surface&#39;</span><span class="p">])</span>

<span class="c1"># Add material to the mesh&#39;s material slots</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
</code></pre></div>
<p>A node's inputs and outputs can be referenced by name. This can then be used to set values on inputs, or connect outputs to inputs, as shown. For example, for the Principled BSDF node above:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">shader</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="p">[</span><span class="s1">&#39;Base Color&#39;</span><span class="p">,</span> <span class="s1">&#39;Subsurface&#39;</span><span class="p">,</span> <span class="s1">&#39;Subsurface Radius&#39;</span><span class="p">,</span> <span class="s1">&#39;Subsurface Color&#39;</span><span class="p">,</span> <span class="s1">&#39;Metallic&#39;</span><span class="p">,</span> 
<span class="s1">&#39;Specular&#39;</span><span class="p">,</span> <span class="s1">&#39;Specular Tint&#39;</span><span class="p">,</span> <span class="s1">&#39;Roughness&#39;</span><span class="p">,</span> <span class="s1">&#39;Anisotropic&#39;</span><span class="p">,</span> <span class="s1">&#39;Anisotropic Rotation&#39;</span><span class="p">,</span> 
<span class="s1">&#39;Sheen&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheen Tint&#39;</span><span class="p">,</span> <span class="s1">&#39;Clearcoat&#39;</span><span class="p">,</span> <span class="s1">&#39;Clearcoat Roughness&#39;</span><span class="p">,</span> <span class="s1">&#39;IOR&#39;</span><span class="p">,</span> <span class="s1">&#39;Transmission&#39;</span><span class="p">,</span> 
<span class="s1">&#39;Transmission Roughness&#39;</span><span class="p">,</span> <span class="s1">&#39;Emission&#39;</span><span class="p">,</span> <span class="s1">&#39;Emission Strength&#39;</span><span class="p">,</span> <span class="s1">&#39;Alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;Normal&#39;</span><span class="p">,</span> 
<span class="s1">&#39;Clearcoat Normal&#39;</span><span class="p">,</span> <span class="s1">&#39;Tangent&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">shader</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="p">[</span><span class="s1">&#39;BSDF&#39;</span><span class="p">]</span>
</code></pre></div>
<p>The <code>location</code> attributes set above are not strictly needed if you're not going to work on the shader network in the Shader Editor in the UI. But they help to make the node network layout somewhat visually pleasing.</p>
<h3 id="material-slots">Material slots<a class="headerlink" href="#material-slots" title="Permanent link">&para;</a></h3>
<p>The last line in the Python code above adds the created material to the mesh's material slots. An object can have multiple materials assigned to it and each assigned material uses a so-called material slot. Each polygon in a mesh can only use a single material, by specifying the material index (i.e. slot) to use for that polygon. This allows different parts of a mesh to use different shaders. </p>
<p>By default all faces in a mesh will reference material slot 0. But here's an example of a cube mesh that uses 3 different materials:</p>
<p><img alt="" src="../../images/multi_material.png" /></p>
<p>Inspecting the underlying material data:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Get the mesh, as the material is linked to the mesh by default</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># The material slots used</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;black-white checkered&#39;</span><span class="p">],</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;voronoi&#39;</span><span class="p">]]</span>

<span class="c1"># Polygon -&gt; slot index</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span>
<span class="mi">0</span>
</code></pre></div>
<p>Material indices can be set per polygon, or set as an array in one go:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Material slot index for a single polygon </span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">material_index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Set all polygon material indices</span>
<span class="n">face_materials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">m</span><span class="o">.</span><span class="n">polygons</span><span class="o">.</span><span class="n">foreach_set</span><span class="p">(</span><span class="s1">&#39;material_index&#39;</span><span class="p">,</span> <span class="n">face_materials</span><span class="p">)</span>
<span class="c1"># Force an update of the mesh, needed in this case</span>
<span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</code></pre></div>
<h2 id="custom-properties">Custom properties<a class="headerlink" href="#custom-properties" title="Permanent link">&para;</a></h2>
<p>Sometimes it can useful to be able to control certain values that you use in a script from the UI. The most flexible, but also most complex, approach would be write an <a href="https://docs.blender.org/manual/en/latest/advanced/scripting/addon_tutorial.html">add-on</a>. However, in quite a few cases there's a simpler alternative if all you need to control are simple Python values, like an int, float, string or list. From Python you can set custom properties on pretty much any Blender Python data block (see <a href="https://docs.blender.org/manual/en/latest/files/data_blocks.html#custom-properties">here</a> for more details) and then access those values from the UI:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;My prop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">123.4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;My 2nd prop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../../images/custom_properties.png" /></p>
<p>This works, of course, both ways: adding or editing a value from the UI will update the value(s) available through Python. You can then use these values in a script, for example to control a number of objects to create, set a 3D coordinate, etc. See <a href="https://docs.blender.org/api/current/info_quickstart.html#custom-properties">here</a> for more details and examples.</p>
<h2 id="into-the-deep-end">Into the deep end...<a class="headerlink" href="#into-the-deep-end" title="Permanent link">&para;</a></h2>
<p>Here we go deeper into some more exotic topics, but which can be of interest with more advanced Python scripting and complex scene setups.</p>
<h3 id="data-block-users-and-garbage-collection">Data-block users and garbage collection<a class="headerlink" href="#data-block-users-and-garbage-collection" title="Permanent link">&para;</a></h3>
<p>Blender uses a system based on reference-counting to decide when data-blocks have become unused and can get purged. In the short video below we show some of the details of this scheme:</p>
<iframe width="800" height="450" src="https://www.youtube.com/embed/3y2652P42Wg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>The video shows the <code>Orphan Data</code> outliner mode, but there are several <a href="https://docs.blender.org/manual/en/latest/editors/outliner/interface.html#display-mode">modes</a> that can be used to get detailed insight into the current state of Blender internals:</p>
<ul>
<li>
<p>The <strong><code>Blender File</code></strong> mode gives a high-level overview of a file's contents, including some of the more implicit data block types, such as Workspaces.</p>
</li>
<li>
<p>The <strong><code>Data API</code></strong> mode provides an even more detailed view. It is actually a great way to inspect all the gory details of Blender's internal data structures. It will show all data-blocks by type and their attributes. Some attributes can be even be edited in this outliner mode.</p>
</li>
<li>
<p>The <strong><code>Orphan Data</code></strong> mode shows data blocks that do not have any users and which will not be saved (unless they are marked to have a fake user). Some of the data-blocks you see here might not have been created by you, but are used by Blender internally, for example the Brushes.</p>
</li>
</ul>
<p>Although the video only focused on materials, the way data-block lifetime is managed using the user counts is general to <em>all types of data-blocks</em> in Blender. But there are subtle differences in whether a data-block is really deleted or just has a link to it removed:</p>
<ul>
<li>
<p>Whenever the term "unlink" is used it means that a link to that data-block is removed and its user count decreased, but the data-block itself will still be in memory. An example of this is clicking the X next to a mesh's material in the Material Properties.</p>
</li>
<li>
<p>If the UI uses the term "delete" it means the data-block is deleted immediately from memory. Any data-blocks linked from the deleted data-block will have their users count decreased. An example of this is deleting a Camera object in the 3D view: the Camera object's data-block is deleted from memory, but the Camera <em>object data</em> data-block (containing the actual camera settings) is still in memory, which you can check in the Orphan Data mode of the outliner.</p>
</li>
</ul>
<p>The usage count of data-blocks can also be queried from Python:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Two cube meshes using the same material</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="mi">2</span>

<span class="c1"># Add a new material, set one of the cubes to use it</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material.001&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="mi">1</span>

<span class="c1"># &lt;Delete Cube.001 object in the UI&gt;</span>

<span class="c1"># Hmmm, still has a user?</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material.001&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="mi">1</span>

<span class="c1"># The reason is we deleted the Cube.001 *object*, but</span>
<span class="c1"># the Cube.001 *mesh* is still alive (as its usage count</span>
<span class="c1"># was merely decremented) and it still references the material</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;blender_console&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">KeyError</span><span class="p">:</span> <span class="s1">&#39;bpy_prop_collection[key]: key &quot;Cube.001&quot; not found&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">users</span>
<span class="mi">0</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube.001&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material&#39;</span><span class="p">]]</span>
</code></pre></div>
<p>The <code>use_fake_user</code> attribute of a data block controls whether a Fake user is set, similar to the checkbox in the UI.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In most cases you probably don't want to manually delete data blocks from a file and only use the normal UI operations for that. But it is possible for cases that need it. Truly purging a data block from Python can be done with the relevant <code>remove()</code> method, e.g. </p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">active_object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">o</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="p">[</span><span class="s1">&#39;Cube&#39;</span><span class="p">]</span>

<span class="c1"># Remove the Mesh data-block from the file</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">meshes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[]</span>
</code></pre></div>
<p>Note that in the case of deleting object data (in this case a Mesh) any Objects referencing that object data <a href="https://docs.blender.org/manual/en/latest/files/data_blocks.html#removing-data-blocks">also get removed</a>!</p>
<p>A second thing to note is the above code does not actually update the current Blender file on disk. That only happens on an explicit save action (e.g. through the <strong><code>File</code></strong> menu or using the relevant operator from Python). </p>
</div>
<h3 id="a-note-on-bpydata-bpydataobjects">A note on <code>bpy.data</code>, <code>bpy.data.objects</code>, ...<a class="headerlink" href="#a-note-on-bpydata-bpydataobjects" title="Permanent link">&para;</a></h3>
<p>We have been using <code>bpy.data.objects</code> in most examples above to access objects in the scene. This is actually not completely clean, as <code>bpy.data.objects</code> holds all objects in the <em>Blender file</em>. Usually, the distinction doesn't matter as you only have one scene, but a Blender file can hold multiple scenes, each with their own set of objects:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># A file with two scenes, each with their own set of objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene.001&#39;</span><span class="p">]]</span>

<span class="c1"># Current scene</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene&#39;</span><span class="p">]</span>

<span class="c1"># And its objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top Cube&#39;</span><span class="p">]]</span>

<span class="c1"># &lt;Select different scene&gt;</span>

<span class="c1"># Different current scene</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene.001&#39;</span><span class="p">]</span>

<span class="c1"># And its objects</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube.001&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top Cube.001&#39;</span><span class="p">]]</span>

<span class="c1"># All objects in the file</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube.001&#39;</span><span class="p">],</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top Cube&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top Cube.001&#39;</span><span class="p">]]</span>
</code></pre></div>
<p>Although objects can also be shared between scenes:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Two scenes</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene.001&#39;</span><span class="p">]]</span>

<span class="c1"># First scene, cubes are local to scene, torus is shared between scenes</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Torus&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">],</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top Cube&#39;</span><span class="p">]]</span>

<span class="c1"># Second scene, different cubes, torus is shared</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene.001&#39;</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="p">[</span><span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube.001&#39;</span><span class="p">],</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top Cube.001&#39;</span><span class="p">],</span> 
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Torus&#39;</span><span class="p">]]</span>
</code></pre></div>
<p>The point here is that <code>bpy.data.objects</code>, and every other attribute under <code>bpy.data</code>, holds values of the complete <em>Blender file</em>. Per-scene values are available through attributes of a <code>Scene</code> object, e.g. <code>bpy.context.scene.objects</code>. For certain use cases this distinction matters.</p>
<h3 id="parenting">Parenting<a class="headerlink" href="#parenting" title="Permanent link">&para;</a></h3>
<p>An object's parent can be queried or set simply through its <code>parent</code> attribute, which needs to reference another Object (or <code>None</code>). But when parenting is involved the use of transformation matrices becomes somewhat more complex. Suppose we have two cubes above each other, the top cube transformed to Z=5 and the bottom cube to Z=2:</p>
<p><img alt="" src="../../images/parented_cubes2.png" /></p>
<p>Using the 3D viewport we'll now parent the bottom cube to the top cube (<strong><code>LMB</code></strong> click bottom cube, <strong><code>Shift-LMB</code></strong> click top cube, <strong><code>Ctrl-P</code></strong>, select <strong><code>Object</code></strong>) and inspect the values in Python:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top cube&#39;</span><span class="p">]</span>

<span class="c1"># The bottom cube is still located in the scene at Z=2, </span>
<span class="c1"># even after parenting, as is expected</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
</code></pre></div>
<p>If an object has a parent its <code>matrix_local</code> attribute will contain the transformation <em>relative to its parent</em>, while <code>matrix_world</code> will contain the resulting net object-to-world transformation. If no parent is set then <code>matrix_local</code> is equal to <code>matrix_world</code>. </p>
<p>Let's check the bottom cube's local matrix value:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Correct, it is indeed -3 in Z relative to its parent</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_local</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
</code></pre></div>
<p>As already shown above the <code>parent</code> attribute can be used to inspect and control the parenting relationship:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
<span class="c1"># None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top cube&#39;</span><span class="p">]</span>

<span class="c1"># Remove parent</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
<p>At this point the two cubes are no longer parented and are at Z=2 ("Bottom cube") and Z=5 ("Top cube") in the scene. But when we restore the parenting relationship <em>from Python</em> something funny happens <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Set parent back to what it was</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Top cube&#39;</span><span class="p">]</span>
</code></pre></div>
<p><img alt="" src="../../images/parented_cubes3.png" /></p>
<p>The reason for the different position of the cube called "Bottom cube" (which is now on top) is that when using the UI to set up a parenting relationship it does more than just setting the <code>parent</code> attribute of the child object. There's also something called the parent-inverse matrix. Let's inspect it and the other matrix transforms we've already seen for the current (unexpected) scene:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Identity matrix, i.e. no transform</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_parent_inverse</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="c1"># Hmmm, this places the &quot;Bottom cube&quot; 2 in Z *above* its parent at Z=5...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_local</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="c1"># ... so it indeed ends up at Z=7 as we saw (above &quot;Top cube&quot;)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
</code></pre></div>
<p>So what happened here? Apparently the <code>matrix_local</code> matrix changed from its value of Z=-3 as we saw earlier. The answer is that when you set up a parenting relationship <em>using the UI</em> the parent-inverse matrix is set to the inverse of the current parent transformation (as the name suggests) while <code>matrix_local</code> is updated to <code>inverse(parent.matrix_world) @ to_become_child.matrix_world</code>.</p>
<p>If we clear the <code>parent</code> value from Python and redo the parenting in the UI we can see this in the resulting transform matrices:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># &lt;parent &quot;Bottom cube&quot; to &quot;Top cube&quot; in the UI&gt;</span>

<span class="c1"># Was identity, is now indeed the inverse of transforming +5 in Z</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_parent_inverse</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">),</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="c1"># Was Z=2, is now 2-5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_local</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>

<span class="c1"># Was Z=7</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="s1">&#39;Bottom cube&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">matrix_world</span>
<span class="n">Matrix</span><span class="p">(((</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)))</span>
</code></pre></div>
<p>The reason for this behaviour is that when doing parenting in the 3D viewport you usually do not want the object that you are setting as the child to move. So the parenting matrices are adjusted accordingly when the parenting relationship is set up. But when we simply set <code>parent</code> from Python the <code>matrix_local</code> value is used as is, causing our bottom cube to suddenly move up, as it is used as the transform relative to its parent, while it actually would need a different value to stay in place.</p>
<p>There's actually quite a bit more going on with all the different parenting options available from the UI. See <a href="https://docs.blender.org/manual/en/latest/scene_layout/object/editing/parent.html">this page</a> for more details.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>The same thing happens when setting the parent in the UI using <strong><code>Object Properties &gt; Relations &gt; Parent</code></strong>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: May 24, 2021 09:45:41
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../4_volumetric_data/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Visualizing volumetric data
            </div>
          </div>
        </a>
      
      
        <a href="../../advanced_materials/introduction/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Introduction
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018-2021 SURF
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
        <a href="https://www.surf.nl"><img style="height:48px" src=../../../../images/surf-logo.svg></a>
        <a href="https://prace-ri.eu/"><img style="height:48px" src=../../../../images/prace-logo.png></a>                            
        
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/SURF_onderzoek" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

        <span style="; font-size:75%"><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.              </span>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.5cf3e710.min.js"></script>
      
    
  </body>
</html>